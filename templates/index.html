<!-- FILEPATH: /d:/主任的domjudge/Django_getZerojudge/getZerojudge/templates/create.html -->
{% extends "base.html" %}
{% load static %}
{% block title %}題目列表{% endblock title %}
{% block content %}
<!-- 引入 jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- 引入 DataTables CSS -->
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.7/css/jquery.dataTables.min.css">
<!-- 引入 DataTables JS -->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js"></script>
<!-- 在表格上应用 DataTables -->
{% comment %} <link rel="stylesheet" href="{% static "css/index.css" %}"> {% endcomment %}
{% endblock content %}

{% block body %}
<div class="container card">
    <table  class="table table-striped " id="myTable">
        <thead>
            <tr>
                <th>標題</th>
                <th>創建日期</th>
                <th>修改日期</th>
                <th>操作</th>
            </tr>
        </thead>
        <tbody>
            {% for problem in problem_list %}
                <tr class="align-middle">
                    <td><a href="{% url 'create' problem.id %}">{{ problem.title }}</a></td>
                    <td>{{ problem.created_time }}</td>
                    <td>{{ problem.edited_time }}</td>
                    <td><button class="btn btn-danger" onclick="deleteProblem({{problem.id}})">刪除</button></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

<script>
    let table = new DataTable('#myTable');
    function deleteProblem(id){
        const url = "{% url 'delete_problem'  %}";
        if(confirm("確定要刪除嗎?")){
            $.ajax({
                url: url,
                type: "POST",
                data: {
                    'cid': id,
                    'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function (data) {
                    alert(data);
                    location.reload();
                },
                error: function (xhr, ajaxOptions, thrownError) {
                    alert(xhr.status,thrownError);
                }
                
            });
        }
            return false;
    }
</script>
{% endblock body %}